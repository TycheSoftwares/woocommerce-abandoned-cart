var Modal,wcal_clicked_cart_id,$wcal_get_email_address,$wcal_customer_details,$wcal_cart_total,$wcal_abandoned_date,$wcal_abandoned_status,email_body,$wcal_cart_status,$wcal_show_customer_detail;jQuery(function(a){(Modal={init:function(){a(document.body).on("click",".wcal-js-close-modal",this.close),a(document.body).on("click",".wcal-modal-overlay",this.close),a(document.body).on("click",".wcal-js-open-modal",this.handle_link),a(document.body).on("click",".wcal_customer_detail_modal",this.handle_customer_details),a(document.body).on("mousedown",".wcal-js-open-modal",this.handle_link_mouse_middle_click),a(window).resize(function(){Modal.position()}),a(document).keydown(function(a){27==a.keyCode&&Modal.close()})},handle_customer_details:function(l){l.preventDefault(),-1==a(l.target).text().indexOf("Hide")?(a(".wcal_modal_customer_all_details").fadeIn(),Modal.position(),a(l.target).text("Hide Details")):(a(".wcal_modal_customer_all_details").fadeOut(),Modal.position(),a(l.target).text("Show Details"))},handle_link_mouse_middle_click:function(a){if(2==a.which){var l=window.location.href;return this.href=l,a.preventDefault(),!1}},handle_link:function(l){l.preventDefault();var t,e,d,o,c=a(this),i="";if(-1==window.location.href.indexOf("action=emailstats")?(t=(e=(d=(o=c.closest("tr")[0]).getElementsByTagName("td")[1].innerHTML).split("<div"))[0],$wcal_customer_details=o.getElementsByTagName("td")[2].innerHTML,$wcal_cart_total=o.getElementsByTagName("td")[3].innerHTML,$wcal_abandoned_date=o.getElementsByTagName("td")[4].innerHTML,$wcal_cart_status=$wcal_abandoned_status=o.getElementsByClassName("status")[0].firstChild.innerText):(i="send_email",t="",$wcal_customer_details="",$wcal_cart_total="",$wcal_abandoned_date="",$wcal_cart_status=""),email_body='<div class="wcal-modal__body"> <div class="wcal-modal__body-inner"> <table cellspacing="0" cellpadding="6" border="1" class="wcal-cart-table"> <thead><th>Email Address</th><th>Customer Details</th><th>Order Total</th><th> Abandoned Date</th></tr></thead><tbody><tr><td>'+t+"</td><td>"+$wcal_customer_details+($wcal_show_customer_detail='<br><a href="#" id "wcal_customer_detail_modal"> Show Details </a>')+"</td><td>"+$wcal_cart_total+" </td><td>"+$wcal_abandoned_date+" </td></tr></tbody></table></div> </div>","ajax"==c.data("modal-type")){wcal_clicked_cart_id=c.data("wcal-cart-id"),Modal.open("type-ajax"),Modal.loading();var s={action:"wcal_abandoned_cart_info",wcal_cart_id:wcal_clicked_cart_id,wcal_email_address:t,wcal_customer_details:$wcal_customer_details,wcal_cart_total:$wcal_cart_total,wcal_abandoned_date:$wcal_abandoned_date,wcal_abandoned_status:$wcal_cart_status,wcal_current_page:i,ajax_nonce:wcal_details_modal_params.wcal_details_modal_nonce};a.post(ajaxurl,s,function(a){Modal.contents(a)})}},open:function(l){$wcal_cart_status="",a(document.body).addClass("wcal-modal-open").append('<div class="wcal-modal-overlay"></div>');var t='<div class="wcal-modal '+l+'"><div class="wcal-modal__contents"> <div class="wcal-modal__header"><h1>Cart #'+wcal_clicked_cart_id+"</h1>"+$wcal_cart_status+"</div>"+email_body+' <div class = "wcal-modal-cart-content-hide" id ="wcal_remove_class">  </div> </div>  <div class="wcal-icon-close wcal-js-close-modal"></div>    </div>';a(document.body).append(t),this.position()},loading:function(){a(document.body).addClass("wcal-modal-loading")},contents:function(l){a(document.body).removeClass("wcal-modal-loading"),l=l.replace(/\\(.)/mg,"$1"),a(".wcal-modal__contents").html(l),this.position()},close:function(){a(document.body).removeClass("wcal-modal-open wcal-modal-loading"),a(".wcal-modal, .wcal-modal-overlay").remove()},position:function(){a(".wcal-modal__body").removeProp("style");var l=a(".wcal-modal__header").outerHeight(),t=a(".wcal-modal").height(),e=a(".wcal-modal").width(),d=a(".wcal-modal__body").outerHeight();a(".wcal-modal").css({"margin-left":-e/2,"margin-top":-t/2}),t<d+l-5&&a(".wcal-modal__body").height(t-l)}}).init()});